(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{494:function(e,t,n){var content=n(530);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(28).default)("3263eeca",content,!0,{sourceMap:!1})},529:function(e,t,n){"use strict";n(494)},530:function(e,t,n){var r=n(27)(!1);r.push([e.i,"textarea::-moz-placeholder{text-align:center;position:absolute;top:150px;bottom:0;left:0;right:0;margin:auto}textarea:-ms-input-placeholder{text-align:center;position:absolute;top:150px;bottom:0;left:0;right:0;margin:auto}textarea::placeholder{text-align:center;position:absolute;top:150px;bottom:0;left:0;right:0;margin:auto}",""]),e.exports=r},595:function(e,t,n){"use strict";n.r(t);var r=n(5),o=(n(31),n(7),n(37),n(108),n(66),n(6),n(32),n(57),{props:["map","switch"],data:function(){return{coordinates:[],autoIncrement:0,currentMarker:{},markers:[],polyline:null,exponentialBackoff:1e3}},watch:{coordinates:function(){this.coordinates&&(this.$refs.polyline.value=this.deleteIndexKey(this.coordinates))},map:function(e){var t=this;this.switch&&(e.addListener("click",(function(e){t.onClickMap(e)})),this.markers.forEach((function(marker){marker.addListener("dragend",(function(e){t.onDragMarker(e,index)})),marker.setDraggable(!0)})))},switch:function(e){this.mapMarkerEvent(e)}},methods:{editCurrentCoordinate:function(){var e=this;this.coordinates=this.coordinates.map((function(t){return t.index==e.currentMarker.index?Object.assign({},t,e.currentMarker):t}))},onClickMap:function(e){var t=this.autoIncrement,n=this.makeLatLng(e,t);this.coordinates.push(n),this.makeMarkerPush(n,t),this.makePolylinePush(this.coordinates),this.currentMarker=Object.assign({},this.currentMarker,n),this.autoIncrement++},onDragMarker:function(e,t){var n=this.makeLatLng(e,t),r=this.coordinates.findIndex((function(marker){return marker.index===t}));this.coordinates[r]=Object.assign({},this.coordinates[r],n),this.currentMarker=Object.assign({},this.currentMarker,n),this.makePolylinePush(this.coordinates),this.$refs.polyline.value=this.deleteIndexKey(this.coordinates)},onChangeText:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$parent.$data.loading=!0,""!=e.$refs.polyline.value){t.next=6;break}e.resetAll(),e.$parent.$data.loading=!1,t.next=11;break;case 6:return n=JSON.parse(JSON.stringify(e.coordinates)),t.next=9,e.isValidJson(e.$refs.polyline.value);case 9:t.sent?(e.setCoordinates(),e.$parent.$data.loading=!1):(2,e.exponentialBackoff=2*e.exponentialBackoff,r=e,o=setTimeout((function(){r.onChangeText()}),r.exponentialBackoff),e.exponentialBackoff>=8e3&&(clearInterval(o),e.exponentialBackoff=1e3,e.coordinates=n,e.$parent.$data.loading=!1,alert("not json")));case 11:case"end":return t.stop()}}),t)})))()},setCoordinates:function(){var e=this;this.exponentialBackoff=1e3;var t=JSON.parse(this.$refs.polyline.value);t.length==this.coordinates.length?this.coordinates=this.coordinates.map((function(e,i){return Object.assign({},e,t[i])})):this.coordinates=t.map((function(t){return t=Object.assign({},t,{index:e.autoIncrement}),e.autoIncrement++,t})),this.redraw(this.coordinates)},reverse:function(){this.coordinates.reverse(),this.markers.reverse()},resetAll:function(){0!==this.markers.length&&(this.resetMarkersPolyline(),this.markers=[],this.polyline=null,this.coordinates=[],this.$refs.polyline.value=null)},resetMarkersPolyline:function(){0!==this.markers.length&&(this.polyline.setMap(null),this.markers.forEach((function(marker){marker.setMap(null)})))},redraw:function(e){var t=this,n=e.map((function(e){return t.makeMarker(e,e.index)})),polyline=this.makePolyline(e);0!==this.markers.length&&this.polyline.setMap(null),setTimeout((function(){0!==t.markers.length&&t.markers.forEach((function(marker){marker.setMap(null)})),t.markers=n,t.polyline=polyline,t.mapMarkerEvent(t.switch)}),100)},makeLatLng:function(e,t){var n=e.latLng.lat(),r=e.latLng.lng();return{lat:Math.round(1e6*n)/1e6,lng:Math.round(1e6*r)/1e6,index:t}},makeMarkerPush:function(e,t){var marker=this.makeMarker(e,t);this.markers.push(marker)},makeMarker:function(e,t){var n=this,o=1;this.switch||(o=0);var marker=new google.maps.Marker({map:this.map,position:new google.maps.LatLng(e.lat,e.lng),draggable:!0,zIndex:o});return marker.addListener("click",Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.coordinates.filter((function(marker){return marker.index!==t}));case 2:n.coordinates=e.sent,n.redraw(n.coordinates);case 4:case"end":return e.stop()}}),e)})))),marker.addListener("dragend",(function(e){n.onDragMarker(e,t)})),marker},makePolylinePush:function(e){var polyline=this.makePolyline(e);this.polyline&&this.polyline.setMap(null),this.polyline=polyline},makePolyline:function(e){return new google.maps.Polyline({map:this.map,path:e,strokeWeight:3})},deleteIndexKey:function(e){var t=JSON.parse(JSON.stringify(e));return JSON.stringify(t.map((function(e){return delete e.index,e}))).replace(/\s+/g,"")},isValidJson:function(e){try{return JSON.parse(e),!0}catch(e){return!1}},mapMarkerEvent:function(e){var t=this;e?(this.map.addListener("click",(function(e){t.onClickMap(e)})),this.markers.forEach((function(marker){marker.setZIndex(1),marker.setDraggable(!0)}))):this.markers.forEach((function(marker){marker.setZIndex(0),marker.setDraggable(!1)}))}}}),l=(n(529),n(71)),c=n(83),d=n.n(c),h=n(420),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticStyle:{padding:"9px"}},[n("div",[n("div",[e._v("lat:"),e.currentMarker.lat?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentMarker.lat,expression:"currentMarker.lat"}],staticStyle:{"background-color":"white"},attrs:{disabled:""},domProps:{value:e.currentMarker.lat},on:{input:[function(t){t.target.composing||e.$set(e.currentMarker,"lat",t.target.value)},e.editCurrentCoordinate]}}):e._e()]),e._v(" "),n("div",[e._v("lng:"),e.currentMarker.lng?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentMarker.lng,expression:"currentMarker.lng"}],staticStyle:{"background-color":"white"},attrs:{disabled:""},domProps:{value:e.currentMarker.lng},on:{input:[function(t){t.target.composing||e.$set(e.currentMarker,"lng",t.target.value)},e.editCurrentCoordinate]}}):e._e()])])]),e._v(" "),n("v-btn",{on:{click:e.resetAll}},[e._v("リセット")]),e._v(" "),n("v-btn",{on:{click:e.reverse}},[e._v("リバース")]),e._v(" "),n("v-btn",{on:{click:e.save}},[e._v("更新")]),e._v(" "),n("textarea",{ref:"polyline",staticStyle:{width:"100%","background-color":"white","font-size":"12px","word-break":"break-all"},attrs:{placeholder:"JSON形式で記入してください",cols:"30",rows:"30"},on:{input:e.onChangeText}})],1)}),[],!1,null,null,null);t.default=component.exports;d()(component,{VBtn:h.a})}}]);